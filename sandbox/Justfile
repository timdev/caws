# Start Claude Code inside the container (starts container if needed)
claude:
    @docker compose up -d
    docker compose exec caws-dev claude chat --dangerously-skip-permissions

# Start the development container
up:
    docker compose up -d

# Stop the development container
down:
    docker compose down

# Enter the development container shell
shell:
    docker compose exec caws-dev bash

# Build caws inside the container
build:
    docker compose exec caws-dev go build -o caws

# Run tests inside the container
test:
    docker compose exec caws-dev ./test/e2e/run_all.sh

# Rebuild the Docker image (use after changing Dockerfile)
rebuild:
    docker compose build --no-cache

# Show container logs
logs:
    docker compose logs -f caws-dev

# Clean up container and image (preserves volumes with Claude settings)
clean:
    docker compose down
    docker rm -f caws-dev || true
    docker rmi caws-dev || true

# Nuclear option: clean everything including volumes
nuke:
    docker compose down -v
    docker rm -f caws-dev || true
    docker rmi caws-dev || true

# Show container/compose status
status:
    docker compose ps